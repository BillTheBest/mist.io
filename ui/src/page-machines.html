<link rel="import" href="../bower_components/app-route/app-route.html">

<link rel="import" href="machines/machine-create.html">
<link rel="import" href="machines/machine-page.html">

<link rel="import" href="page-items.html">

<dom-module id="page-machines">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <app-route route="{{route}}"
                pattern="/:machine"
                data="{{data}}"></app-route>

    <page-items name="machines" class="keys" model="[[model]]" items="[[model.machinesArray]]" sections="[[sections]]" section="[[sections.machines]]" onboarding="[[onboarding]]" hidden$=[[!_isListActive(route.path)]]></page-items>
    <machine-create model="[[model]]" sections="[[sections]]" section="[[sections.machines]]" machines-fields="[[machinesFields]]" hidden$=[[!_isAddPageActive(route.path)]]></machine-create>
    <machine-page model="[[model]]" params="[[_getMachine(data.machine, model.machines)]]" sections="[[sections]]" section="[[sections.machines]]" hidden$=[[!_isDetailsPageActive(route.path)]]></machine-page>
  </template>

  <script>
    Polymer({

      is: 'page-machines',

      properties: {
        model: Object,
        sections: Array,
        onboarding: Object,
        data: Object,
        machinesFields: {
            type: Array,
            value: MACHINE_CREATE_FIELDS
        },

      },

      _isAddPageActive: function(path) {
          return path == '/+create';
      },
      _isDetailsPageActive: function(path) {
          return path && path != '/+create';
      },
      _isListActive: function(path) {
          return !path;
      },
      _getMachine: function(id) {
        if (id && this.model.machines[id])
          return this.model.machines[id];
      }

    });
  </script>
</dom-module>
