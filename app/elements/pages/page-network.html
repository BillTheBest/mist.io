<link rel="import" href="../../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">

<link rel="import" href="../section-symbol/section-symbol.html">
<link rel="import" href="../tag-link/tag-link.html">
<link rel="import" href="../theme-color/theme-color.html">
<link rel="import" href="../element-action-menu/element-action-menu.html">
<link rel="import" href="../element-table/element-table.html">
<link rel="import" href="../element-table-cards/element-table-cards.html">
<link rel="import" href="../responsive-element/responsive-element.html">

<dom-module id="page-network">
	<link rel="import" type="css" href="../../styles/main.css">
	<link rel="import" type="css" href="page-network.css">

	<template>
		<paper-drawer-panel id="drawerPanel" responsive-width="900px" narrow="{{narrowMode}}" drawer-width="272px" disable-edge-swipe>

			<app-sidebar tag="[[tag]]" sections="{{sections}}" current="[[section.id]]" drawer></app-sidebar>

			<paper-header-panel id="container" mode="[[_getMode(narrowMode)]]" view$="[[_actualView(view)]]" main>
				<div class="paper-header">
					<paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
					<h2 class="flex">{{network.name}}</h2>
					<app-bar class="horizontal layout center end-justified" query="{{q}}"></app-bar>
					<paper-icon-button icon="icons:sort"></paper-icon-button>
					<app-user-menu email="marios@mist.io"></app-user-menu>
				</div>
				<div id="content">
					<paper-card class="info-card" heading="Network Information">
						<!-- <paper-button on-tap="listInfo">temp network info helper</paper-button> -->
						<div class="card-content">
							<div id="networkproperties"></div>
							<table class="info-table">
								<tr>
									<td>
										Name
									</td>
									<td>
										[[network.name]]
									</td>
								</tr>
								<tr>
									<td>
										ID
									</td>
									<td>
										[[network.id]]
									</td>
								</tr>
								<tr>
									<td>
										Type
									</td>
									<td>
										[[network.type]]
									</td>
								</tr>
								<template is="dom-if" if="[[network.status]]">
									<tr>
										<td>
											Status
										</td>
										<td>
											[[network.status]]
										</td>
									</tr>
								</template>
								<tr>
									<td>
										Provider
									</td>
									<td>
										[[network.provider]]
									</td>
								</tr>
							</table>
						</div>
					</paper-card>

					<template is="dom-if" if="[[network.subnets.length]]">
						<paper-card class="info-card" heading="Subnets ([[network.subnets.length]])">
							<div class="card-content">
								<table class="info-table">
									<template is="dom-repeat" items="[[network.subnets]]">
										<template is="dom-if" if="[[item.name]]">
											<tr class="info-table-divider">
												<td>
													Name
												</td>
												<td>
													[[item.name]]
												</td>
											</tr>
										</template>
										<template is="dom-if" if="[[item.id]]">
											<tr>
												<td>
													ID
												</td>
												<td>
													[[item.id]]
												</td>
											</tr>
										</template>
										<template is="dom-if" if="[[item.zone]]">
											<tr>
												<td>
													ZoneZone</td>
												<td>
													[[subnet.zone.name]]
												</td>
											</tr>
										</template>
										<template is="dom-if" if="[[item.cidr]]">
											<tr>
												<td>
													Cidr</td>
												<td>
													[[subnet.cidr]]
												</td>
											</tr>
										</template>
										<template is="dom-if" if="[[item.enable_dhcp]]">
											<tr>
												<td>
													DHCP Enabled</td>
												<td>
													[[subnet.enable_dhcp]]
												</td>
											</tr>
										</template>
										<template is="dom-if" if="[[item.gateway_ip]]">
											<tr>
												<td>
													Gateway IP</td>
												<td>
													[[subnet.gateway_ip]]
												</td>
											</tr>
										</template>
									</template>
								</table>
							</div>
						</paper-card>
					</template>

					<paper-card class="info-card" heading="Full Metadata List">
						<div class="card-content">
							<template is="dom-if" if="{{network.tags.length}}">
								<p>Tags:
									<p>{{showExtra(network.tags)}}</p>
									<hr/>
							</template>

							<template is="dom-if" if="{{network.floating_ips.length}}">
								<p>Floating Ips:</p>
								<p>{{showMore(network.floating_ips)}}</p>
								<hr/>
							</template>

							<template is="dom-if" if="{{network.floating_ips.length}}">
								<p>Extra:</p>
								<p>{{showExtra(network.extra)}}</p>
							</template>
						</div>
					</paper-card>
				</div>
				<div class="absolute-bottom-right">
					<paper-menu-button vertical-align="bottom" horizontal-align="right">
						<paper-fab icon="add" class="dropdown-trigger" alt="bottom align">Actions</paper-fab>
						<paper-menu class="dropdown-content">
							<paper-button on-click="deleteNetwork">Add Machine</paper-button>
						</paper-menu>
					</paper-menu-button>
				</div>
			</paper-header-panel>
		</paper-drawer-panel>
	</template>
</dom-module>

<script>
	Polymer({
		is: 'page-network',
		enableCustomStyleProperties: true,
		properties: {
			router: Object,
			pageTitle: {
				type: String
			},
			params: {
				type: Object,
				notify: true
			},
			sections: Array,
			section: {
				type: Object,
				notify: true,
				value: {}
			},
			tag: {
				String, value: ""
			},
			network: Object
		},
		ready: function() {

		},
		attached: function() {

		},
		listInfo: function(e) {
			var info = '';
			for (var prop in this.network) {
				info += prop + " : " + this.network[prop] + ", ";
			}
			this.$.networkproperties.textContent = info;
		},
		showExtra: function(extra) {
			var e = extra;
			var info = '';
			for (var prop in e) {
				info += prop + " : " + e[prop] + ", ";
			}
			return info;
		},
		showMore: function(s) {
			var info = '';
			for (var i = 0; i < s.length; s++) {
				info += i + ": " + this.showExtra(s[i]) + ", ";
			}
			return info;
		},
		deleteNetwork: function(_, params) {
			// console.log("clicked delete Network");
		},
	});
</script>
